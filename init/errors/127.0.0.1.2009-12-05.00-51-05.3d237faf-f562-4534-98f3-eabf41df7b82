(dp1
S'output'
p2
S''
sS'layer'
p3
S'/home/dave/web2py/applications/init/views/js/mixtree.js'
p4
sS'code'
p5
S'response.write("//gets the urls for the id spesified\\n//TODO: do this properly\\ngetAudio = function(id, session)\\n{\\n\\t//make request to get audio\\n\\tvar url = \'",escape=False)\nresponse.write( URL(r=request, c=\'audio_links\', f=\'urls_by_id\'))\nresponse.write(\'\\\';\\n\\t//append the id to the request\\n\\turl += \\\'/\\\' + id\\n\\n\\t// make ajax request to get urls in json format\\n\\tvar urls;\\n\\t$.ajax({\\n      \\t\\tasync: false,\\n\\t\\tdataType: "json",\\n\\t\\turl: url,\\n\\t\\tsuccess: function(json)\\n\\t\\t\\t{\\n\\t\\t\\t\\t// the request will return a JSON object containing a list of urls\\n\\t\\t\\t\\turls = json[0];\\n\\t\\t\\t}\\n\\t});\\n\\treturn urls;\\n\\n}\\n\\n//handles the broken url cases\\naudioError = function(id, url, session)\\n{\\n\\talert("audio id: " + id + "(" + url + ") wasn\\\'t found");\\t\\n}\\n\\nvar mixListWin = null;\\n//adds media to the mix list\\nfunction addToMixList(id, title1, title2, type) \\r\\n{\\r\\n\\tvar url = "\',escape=False)\nresponse.write( URL(r=request, c=\'mix_list\', f=\'index\'))\nresponse.write(\'";\\r\\n\\n\\tmixListWin = window.open( "", "mixList", "width=500,height=400" );\\r\\n\\tif( !mixListWin || mixListWin.closed || !mixListWin.addMedia ) \\r\\n\\t{\\r\\n\\t\\tmixListWin = window.open( url, "mixList", "width=500,height=400");\\n\\t\\tvar mixListDelayedAdd = new MixListDelayedAdd(id, title1, title2, type);\\n\\t\\tmixListWin.onload = mixListDelayedAdd.addToMixList;\\r\\n\\t}else\\n\\t\\tmixListWin.addMedia(id, title1, title2, type);\\r\\n}\\n\\n//class to add music to mixlist when it gets opened\\nfunction MixListDelayedAdd(id, title1, title2, type)\\n{\\n\\tthis.id = id;\\n\\tthis.title1 = title1;\\n\\tthis.title2 = title2;\\n\\tthis.type = type;\\n\\n\\tthis.addToMixList = function()\\n\\t{\\n\\t\\tmixListWin.addMedia(id, title1, title2, type);\\n\\t}\\n}\\n\\n//search mixtree\\nfunction search(searchTerm, page) \\n{\\n    if(not page)\\n        page = \\\'\\\';\\n\\tvar youTubeQueryUrl = "http://gdata.youtube.com/feeds/api/videos?start-index=" + page + "&max-results=10&alt=json-in-script&v=2&callback=?&q=";\\n\\tvar mixtreeSearchUrl = \\\'\',escape=False)\nresponse.write( URL(r=request, c=\'audio\', f=\'search\', page))\nresponse.write(\'\\\';\\n\\n\\t$.getJSON(youTubeQueryUrl + searchTerm, displayYouTubeResults);\\n\\t$.getJSON(mixtreeSearchUrl + \\\'/\\\' + searchTerm, displayMixtreeSearchResults);\\n\\treturn false;\\n}\\n\\n//display search results from youtube\\nfunction displayYouTubeResults(data)\\n{\\n\\tvar entries = data.feed.entry || [];\\n\\tvar youTubePlaylist = $(\\\'#youTubeSearchResults\\\').children();\\n\\tyouTubePlaylist.empty();\\n\\t$.each(entries, function(i, entry)\\n\\t{\\n\\t    var playListEntry = [];\\n\\t    var i = 0;\\n\\t    playListEntry[i++] = "<li class=\\\'playlistEntry\\\'> <div class=\\\'playListControls\\\'>";\\n\\t    playListEntry[i++] = "<a href=\\\'#\\\' title=\\\'add to mix list\\\' class=\\\'playListControl\\\' onclick=\\\'";\\n\\t    playListEntry[i++] = "javascript:addToMixList(\\\\"";\\n\\t    playListEntry[i++] = entry.media$group.yt$videoid.$t;\\n\\t    playListEntry[i++] = "\\\\", \\\\"";\\n\\t    playListEntry[i++] = entry.title.$t.replace(\\\'\\\\\\\'\\\',\\\'\\\');\\n\\t    playListEntry[i++] = "\\\\",  \\\\"\\\\", 1)\\\'>+</a>";\\n\\t    playListEntry[i++] = "</div>";\\n\\t    playListEntry[i++] = "<a id=\\\'";\\n\\t    playListEntry[i++] = entry.media$group.yt$videoid.$t;\\n\\t    playListEntry[i++] = "\\\' href=\\\'#\\\' class=\\\'playable youtube\\\' title=\\\'play track\\\'>";\\n\\t    playListEntry[i++] = "<img class=\\\'thumbnails\\\' src=\\\'";\\n\\t    playListEntry[i++] = entry.media$group.media$thumbnail[0].url;\\n\\t    playListEntry[i++] = "\\\'/><span class=\\\'title2\\\'>";\\n\\t    playListEntry[i++] = entry.title.$t.replace(\\\'\\\\\\\'\\\',\\\'\\\');\\n\\t    playListEntry[i++] = "</span> </a> </li>";\\n\\t    youTubePlaylist.append(playListEntry.join(\\\'\\\'));\\n\\t});\\n\\t//call init on page player to initilize the playable items\\n\\tpagePlayer.init();\\n}\\n\\nfunction displayMixtreeSearchResults(json)\\n{\\n\\tvar mixtreePlaylist = $(\\\'#mixtreeSearchResults\\\').children("ul");\\n    var mixtreePagnation = $(\\\'.pagnation\\\');\\n\\tmixtreePlaylist.empty();\\n\\n\\t$.each(json.audio, function(i, audio)\\n\\t{\\n\\t    var playListEntry = [];\\n\\t    var i = 0;\\n\\t    var id = audio.id;\\n\\t    var artist = audio.artist.replace(\\\'\\\\\\\'\\\',\\\'\\\');\\n\\t    var track = audio.track.replace(\\\'\\\\\\\'\\\',\\\'\\\');\\n\\t    playListEntry[i++] = "<li class=\\\'playlistEntry\\\'> <div class=\\\'playListControls\\\'>";\\n\\t    playListEntry[i++] = "<a href=\\\'#\\\' title=\\\'add to mix list\\\' class=\\\'playListControl\\\' onclick=\\\'";\\n\\t    playListEntry[i++] = "javascript:addToMixList(\\\\"";\\n\\t    playListEntry[i++] = id;\\n\\t    playListEntry[i++] = "\\\\", \\\\"";\\n\\t    playListEntry[i++] = artist;\\n\\t    playListEntry[i++] = "\\\\",  \\\\"";\\n\\t    playListEntry[i++] = track;\\t\\t\\n\\t    playListEntry[i++] = "\\\\", 0)\\\'>+</a>";\\n\\t    playListEntry[i++] = "</div>";\\n\\t    playListEntry[i++] = "<a id=\\\'";\\n\\t    playListEntry[i++] = id;\\n\\t    playListEntry[i++] = "\\\' href=\\\'#\\\' class=\\\'playable\\\' title=\\\'play track\\\'>";\\n\\t    playListEntry[i++] = "<span class=\\\'title1\\\'>";\\n\\t    playListEntry[i++] = artist;\\n\\t    playListEntry[i++] = "</span> <span class=\\\'title2\\\'>";\\n\\t    playListEntry[i++] = track;\\n\\t    playListEntry[i++] = "</span> </a> </li>";\\n\\t    mixtreePlaylist.append(playListEntry.join(\\\'\\\'));\\n\\t});\\n\\n    //clear the contents of the pagnation div\\n    mixtreePagnation.empty();\\n    var searchRoot = \\\'\',escape=False)\nresponse.write( URL(r=request, c=\'audio\', f=\'search\'))\nresponse.write(\'\\\' + \\\'/\\\';\\n    //add pagnation links if appliciable\\n    if(json.pagnation.back)\\n       mixtreePagnation.append("<a href=\\\' " + searchRoot + json.pagnation.back + "\\\'> <= </a>"); \\n    if(json.pagnation.forward)\\n       mixtreePagnation.append("<a href=\\\'" + searchRoot + json.pagnation.forward + "\\\'> => </a>");\\n\\n\\t//call init on page player to initilize the playable items\\n\\tpagePlayer.init();\\n}\\n\\n//refresh the users panel via ajax\\nfunction refreshUserPanel()\\n{\\n   \\n    $.get("\',escape=False)\nresponse.write( URL(r=request, c=\'user_panel\', f=\'index\'))\nresponse.write(\'", function(data)\\n        {\\n            $(\\\'#user_panel\\\').replaceWith(data);\\n        }\\n    );   \\n}\\n\',escape=False)'
p6
sS'traceback'
p7
S'Traceback (most recent call last):\n  File "/home/dave/web2py/gluon/restricted.py", line 182, in restricted\n    ccode = compile(code.replace(\'\\r\\n\', \'\\n\'), layer, \'exec\')\n  File "/home/dave/web2py/applications/init/views/js/mixtree.js", line 6\n    var url = \'{{= URL(r=request, c=\'audio_links\', f=\'urls_by_id\')}}\';\nSyntaxError: non-keyword arg after keyword arg\n'
p8
s.